---
import Logo from "./Logo.astro";

export type MenuItem = {
  label: string;
  url: string;
  children?: MenuItem[];
};

export type NavbarButton = {
  text: string;
  href: string;
  style: string;
};

export const menuLeft: MenuItem[] = [
  { label: "New to flying", url: "/new-to-flying" },
  {
    label: "Pilot Training",
    url: "/flight-training",
    children: [
      { label: "Private Pilot Certificate", url: "/flight-training/private-pilot-certificate" },
      { label: "Fear of Flying", url: "/flight-training/fear-of-flying" },
    ],
  },
];

export const menuRight: MenuItem[] = [
  {
    label: "About Us",
    url: "/about-us",
    children: [
      { label: "About Us", url: "/about-us" },
      { label: "Team", url: "/about-us/team" },
      { label: "FAQ", url: "/about-us/faq" },
      { label: "Blog", url: "/blog" },
      { label: "Contact Us", url: "/contact" },
    ],
  },
];

export const buttons: NavbarButton[] = [
  {
    text: `Enroll Now`,
    href: "/#enroll-form",
    style: "bg-amber-800 text-white text-lg rounded-tr-full rounded-br-full px-4 py-2 hover:brightness-110 transition",
  },
];

const { pathname } = Astro.props;
---

<nav id="navbar" class="fixed top-0 w-full z-50 transition-all duration-500">
  <!-- Desktop Menu -->
  <div
    class="relative flex items-center justify-center px-4 py-2 max-w-7xl mx-auto bg-white md:bg-transparent transition-all duration-300 "
  >
    <!-- Left Menu -->
    <ul class="hidden pr-34 mt-18  md:flex gap-8 text-white bg-white/15 py-14 px-4 rounded-bl-full rounded-tl-full ">
      {menuLeft.map((item) => (
        <li class="relative group">
          <a
            href={item.url}
            class="font-medium uppercase transition hover:underline hover:underline-offset-2"
          >
            {item.label}
          </a>
          {item.children && (
            <ul
              class="absolute top-full left-0 min-w-[220px] bg-amber-800 text-white rounded-md opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-300"
            >
              {item.children.map((child) => (
                <li>
                  <a
                    href={child.url}
                    class={`block px-4 hover:bg-amber-700 transition ${
                      child.url === pathname ? "bg-amber-700" : ""
                    }`}
                  >
                    {child.label}
                  </a>
                </li>
              ))}
            </ul>
          )}
        </li>
      ))}
    </ul>

    <!-- Centered Logo -->
    <a
      href="/"
      class="absolute top-14 left-1/2 -translate-x-1/2 shrink-0 w-36 md:w-44 flex justify-center"
    >
      <Logo classes="block md:hidden" />
      <Logo classes="hidden md:block" blackAndWhite={true} />
    </a>

    <!-- Logo size placeholder -->
    <!-- <div class="w-58 mt-18 bg-white/15 "></div> -->

    <!-- Right Menu -->
    <div class="hidden pl-28 mt-18 md:flex items-center gap-8 text-white  py-12 bg-white/15 px-4 rounded-br-full rounded-tr-full">
      <ul class="flex gap-8">
        {menuRight.map((item) => (
          <li class="relative group">
            <a
              href={item.url}
              class="font-medium uppercase transition hover:underline hover:underline-offset-2"
            >
              {item.label}
            </a>
            {item.children && (
              <ul
                class="absolute top-full left-0 min-w-[220px] bg-amber-800 text-white rounded-md opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-300"
              >
                {item.children.map((child) => (
                  <li>
                    <a
                      href={child.url}
                      class={`block px-4 py-2 hover:bg-amber-700 transition ${
                        child.url === pathname ? "bg-amber-700" : ""
                      }`}
                    >
                      {child.label}
                    </a>
                  </li>
                ))}
              </ul>
            )}
          </li>
        ))}
      </ul>

      <!-- Buttons -->
      {buttons.map((button) => (
        <a href={button.href} class={button.style}>
          {button.text}
        </a>
      ))}
    </div>

    <!-- Mobile Hamburger -->
    <button
      id="mobile-toggle"
      class="md:hidden flex flex-col gap-1 text-white focus:outline-none z-50"
      aria-label="Toggle menu"
    >
      <svg
        id="bars"
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <line x1="3" x2="21" y1="6" y2="6" />
        <line x1="3" x2="21" y1="12" y2="12" />
        <line x1="3" x2="21" y1="18" y2="18" />
      </svg>
      <svg
        id="xmark"
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6 hidden"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M6 6l12 12M18 6L6 18" />
      </svg>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="absolute top-full left-0 w-full bg-amber-800 text-white max-h-0 overflow-hidden transition-all duration-500"
  >
    <ul class="flex flex-col px-4 py-2 space-y-2">
      {[...menuLeft, ...menuRight].map((item) => (
        <li class="border-b border-amber-700">
          <a href={item.url} class="block py-3 font-semibold uppercase">{item.label}</a>
          {item.children && (
            <ul class="pl-4 border-l border-amber-600 hidden flex-col space-y-1">
              {item.children.map((child) => (
                <li>
                  <a href={child.url} class="block py-2 text-sm hover:text-amber-300">{child.label}</a>
                </li>
              ))}
            </ul>
          )}
        </li>
      ))}
    </ul>

    <div class="border-t border-amber-700 py-4 px-4">
      {buttons.map((button) => (
        <a href={button.href} class={`${button.style} block w-full text-center`}>{button.text}</a>
      ))}
    </div>
  </div>
</nav>

<script type="module">
  // const navbar = document.getElementById("navbar");
  const toggle = document.getElementById("mobile-toggle");
  const mobileMenu = document.getElementById("mobile-menu");
  const bars = document.getElementById("bars");
  const xmark = document.getElementById("xmark");

  // function handleScroll() {
  //   if (window.scrollY > 40) {
  //     navbar.classList.add("bg-white/60", "backdrop-blur-md", "shadow-md");
  //     navbar.classList.remove("bg-transparent");
  //   } else {
  //     navbar.classList.remove("bg-white/60", "backdrop-blur-md", "shadow-md");
  //     navbar.classList.add("bg-transparent");
  //   }
  // }
  // window.addEventListener("scroll", handleScroll);
  // handleScroll();

  toggle.addEventListener("click", () => {
    const open = mobileMenu.classList.toggle("max-h-screen");
    bars.classList.toggle("hidden", open);
    xmark.classList.toggle("hidden", !open);
    document.body.classList.toggle("overflow-hidden", open);
  });
</script>
