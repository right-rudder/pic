---
import Logo from "./Logo.astro";

export type MenuItem = {
  label: string;
  url: string;
  children?: MenuItem[];
};

export type NavbarButton = {
  text: string;
  href: string;
  style: string;
};

export const menuLeft: MenuItem[] = [
  { label: "New to flying", url: "/new-to-flying" },
  {
    label: "Pilot Training",
    url: "/flight-training",
    children: [
      { label: "Private Pilot Certificate", url: "#" },
      { label: "Commercial Pilot Certificate", url: "#" },
      { label: "Instrument Rating", url: "#" },
      { label: "CFI", url: "#" },
      { label: "CFII", url: "#" },
    ],
  },
];

export const menuRight: MenuItem[] = [
  {
    label: "About Us",
    url: "/about-us",
    children: [
      { label: "About Us", url: "/about-us" },
      { label: "Our Team", url: "/about-us/team" },
      { label: "FAQs", url: "/about-us/faq" },
      { label: "Blog", url: "/blog" },
      { label: "Contact Us", url: "/contact" },
    ],
  },
];

export const buttons: NavbarButton[] = [
  {
    text: `Enroll Now`,
    href: "/#enroll-form",
    style:
      "bg-primary-600 text-white text-2xl rounded-full px-6 py-1 hover:brightness-110 transition",
  },
];

const { pathname } = Astro.props;
---

<nav id="navbar" class="fixed top-10 w-full z-50 transition-all duration-500">
  <!-- Desktop Menu -->
  <div class="relative flex items-center justify-center bg-primary-800/40 backdrop-blur-2xl  rounded-full px-4 py-3 max-w-7xl mx-auto">
    <!-- Wing Menus Container -->
    <div class="hidden md:flex items-center justify-around w-full relative">
      <!-- Left Wing -->
      <ul
        class="flex items-center gap-8 text-white "
      >
        {menuLeft.map((item) => (
          <li class="relative group flex items-center font-semibold text-xl text-center">
            <a
              href={item.url}
              class="font-medium uppercase transition hover:underline hover:underline-offset-2"
            >
              {item.label}
            </a>
            {item.children && (
              <ul
                class="absolute top-full left-0 min-w-[220px] bg-primary-600 text-white rounded-md opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-300"
              >
                {item.children.map((child) => (
                  <li>
                    <a
                      href={child.url}
                      class={`block px-4 py-2 hover:bg-primary-800 transition ${
                        child.url === pathname ? "bg-primary-800" : ""
                      }`}
                    >
                      {child.label}
                    </a>
                  </li>
                ))}
              </ul>
            )}
          </li>
        ))}
      </ul>

      <!-- Centered Logo (overlapping) -->
      <a
        href="#"
        class="absolute left-1/2 -translate-x-1/2 shrink-0 flex justify-center items-center z-10"
      >
        <Logo classes="w-28 md:w-36 drop-shadow-lg" blackAndWhite={true} />
      </a>

      <!-- Right Wing -->
      <div
        class="flex items-center gap-8 text-white "
      >
        <ul class="flex items-center gap-8">
          {menuRight.map((item) => (
            <li class="relative group flex items-center font-semibold text-xl text-center">
              <a
                href={item.url}
                class="font-medium uppercase transition hover:underline hover:underline-offset-2"
              >
                {item.label}
              </a>
              {item.children && (
                <ul
                  class="absolute top-full left-0 min-w-[220px] bg-primary-600 text-white rounded-md opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-300"
                >
                  {item.children.map((child) => (
                    <li>
                      <a
                        href={child.url}
                        class={`block px-4 py-2 hover:bg-primary-800 transition ${
                          child.url === pathname ? "bg-primary-800" : ""
                        }`}
                      >
                        {child.label}
                      </a>
                    </li>
                  ))}
                </ul>
              )}
            </li>
          ))}
        </ul>

        <!-- Buttons -->
        {buttons.map((button) => (
          <a href={button.href} class={button.style}>
            {button.text}
          </a>
        ))}
      </div>
    </div>

    <!-- Mobile Hamburger -->
    <button
      id="mobile-toggle"
      class="md:hidden flex flex-col gap-1 text-white focus:outline-none z-50"
      aria-label="Toggle menu"
    >
      <svg
        id="bars"
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <line x1="3" x2="21" y1="6" y2="6" />
        <line x1="3" x2="21" y1="12" y2="12" />
        <line x1="3" x2="21" y1="18" y2="18" />
      </svg>
      <svg
        id="xmark"
        xmlns="http://www.w3.org/2000/svg"
        class="w-6 h-6 hidden"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M6 6l12 12M18 6L6 18" />
      </svg>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="absolute top-full left-0 w-full bg-primary-800 text-white max-h-0 overflow-hidden transition-all duration-500"
  >
    <div class="border-t border-primary-300 py-4 px-4">
      
      <a href="/" class="w-12">
        <Logo classes="max-w-24 mx-auto bg-white rounded-full" />
      </a>
      
    </div>

    <ul class="flex flex-col px-4 py-2 space-y-2">
      {[...menuLeft, ...menuRight].map((item) => (
        <li class="border-b border-primary-400">
          <a href={item.url} class="block py-3 font-semibold uppercase">{item.label}</a>
          {item.children && (
            <ul class="pl-4 border-l border-primary-300 hidden flex-col space-y-1">
              {item.children.map((child) => (
                <li>
                  <a href={child.url} class="block py-2 text-sm ">{child.label}</a>
                </li>
              ))}
            </ul>
          )}
        </li>
      ))}
    </ul>

    <div class="border-t border-primary-300 py-4 px-4">
      {buttons.map((button) => (
        <a href={button.href} class={`${button.style} btn-accent btn-middle block w-full text-center`}>{button.text}</a>
      ))}
    </div>
  </div>
</nav>

<script type="module">
  const toggle = document.getElementById("mobile-toggle");
  const mobileMenu = document.getElementById("mobile-menu");
  const bars = document.getElementById("bars");
  const xmark = document.getElementById("xmark");

  toggle.addEventListener("click", () => {
    const open = mobileMenu.classList.toggle("max-h-screen");
    bars.classList.toggle("hidden", open);
    xmark.classList.toggle("hidden", !open);
    document.body.classList.toggle("overflow-hidden", open);
  });
</script>
